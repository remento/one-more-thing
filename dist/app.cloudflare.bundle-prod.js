!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t,o){"use strict";class n{constructor(e){const t=e||{};Object.keys(n.prototype).forEach(e=>{t.hasOwnProperty(e)&&(this[e]=t[e])})}}n.prototype.postMessage=window.postMessage,n.prototype.selector="a",n.prototype.recoveryUrl="/one-more-thing/",n.prototype.recoveryContentId="one-more-thing",n.prototype.pmOpenedKey="baton-one-more-thing",n.prototype.storageKey="baton-one-more-thing",n.prototype.loadingBodyContent="<h1>One More Thing...</h1>",n.prototype.pollFreqMS=1500,n.prototype.pollStopAfterMs=2e4,n.prototype.recoveryDelayMS=100,n.prototype.forceLogging=!0,o.d(t,"a",function(){return r});class r extends n{constructor(e){super(e);const t=function(){},o={log:t,warn:t,debug:t},n=this.forceLogging&&window.console||o;this.con_warn=n.warn,this.con_log=n.log,this.con_debug=n.debug,this.store={},this.openingRescue=!1,this.listenMessages(),this.isRecoveryPage()?this.recoveryExists=!0:this.recoveryExists||(this.pollOpener(),this.listenInteraction())}pollOpener(){const e=this.opener&&this.opener!==window&&!this.recoveryExists&&!this.pollOpener_intervalID,t=()=>{this.recoveryExists||this.dead?this.cancelPollOpener():(this.con_debug("baton: pollOpener: interval: send inquiry",this.safeOrigin),this.postMessage.call(this.opener,{type:this.pmOpenedKey,inquiry:this.pmOpenedKey},this.safeOrigin))};this.con_log("baton: pollOpener: startPolling:",e),e&&(this.pollOpener_intervalID=setInterval(t,this.pollFreqMS),setTimeout(()=>{this.cancelPollOpener()},this.pollStopAfterMs),t())}cancelPollOpener(){this.con_log("baton: cancelPollOpener"),clearInterval(this.pollOpener_intervalID),delete this.pollOpener_intervalID}receiveMessage(e){const t=this.pmOpenedKey,o=e.data.type,n=this.isRecoveryPage();this.dead||o!==t||e.source===window||(this.con_log("baton: receiveMessage:",e.data),n&&e.data.inquiry&&(this.con_log("baton: receiveMessage: RESPOND"),this.postMessage.call(e.source,{type:t,response:t,payload:!0},this.safeOrigin)),!n&&e.data.response&&(this.recoveryExists=!0,this.stop()))}listenMessages(){const e=this.receiveMessage.bind(this);window.addEventListener("message",e,!1),this.removeListenMessages=(()=>{window.removeEventListener("message",e,!1)})}removeListenMessages(){this.con_log("baton: removeListenMessages: no listener configured to remove")}XXX_listenInteraction(){const e=e=>{if(this.dead)return;let t=e.target;if(!this.recoveryExists){let o;(e.composedPath&&e.composedPath()||e.path||[t.parentElement.parentElement,t.parentElement,t]).some(e=>{o=e;let n=!!e.parentElement&&e.parentElement.querySelector(this.selector),r=t;do{if(n===r)return!0;r=r.parentElement}while(r&&e.parentElement!==r);return!1})&&"A"===o.nodeName&&!o.target&&(this.con_log("baton: key action triggered",{selector:this.selector,event:e}),o.target="_blank",e.preventDefault=function(){this.con_warn('baton: preventDefault bypassed to preserve link window targeting (target="_blank")')},setTimeout(this.loadRecoveryPage.bind(this),this.recoveryDelayMS))}},t={capture:!0,once:!1,passive:!1};document.body.addEventListener("click",e,t),this.removeListenInteraction=(()=>{document.body.removeEventListener("click",e,t)})}listenInteraction(){const e={capture:!0,once:!1,passive:!1},t=e=>{if(this.dead)return;let t,o=e.target;for(;!t&&o;){if("A"===o.nodeName){t=o;break}o=o.parentElement}if(t){let o=document.querySelectorAll(this.selector);if(new Set(o.values()).has(t))return this.onAnchorSelected(t,e)}};document.body.addEventListener("click",t,e),this.removeListenInteraction=(()=>{document.body.removeEventListener("click",t,e)})}onAnchorSelected(e,t){this.con_log("baton: anchor selected",!e.target,e),e.target||(e.target="_blank",t._preventDefault=t._preventDefault||t.preventDefault,t.preventDefault=function(){this.con_warn('baton: preventDefault bypassed to preserve anchor target functionality (target="_blank"). event._preventDefault is available when this occurs to override. ')},setTimeout(this.loadRecoveryPage.bind(this),this.recoveryDelayMS))}removeListenInteraction(){this.con_log("baton: removeListenInteraction: no listener configured to remove")}loadRecoveryPage(){this.con_log("baton: loading recovery page",this.recoveryUrl),this.recoveryExists=!0,this.openingRescue=!0,window.location.href=this.recoveryUrl}isRecoveryPage(){return this.recoveryUrl===window.location.href||this.recoveryUrl===window.location.pathname||!!this.recoveryContentEl||this.openingRescue}get recoveryContentEl(){return document.getElementById(this.recoveryContentId)}get opener(){return window.opener}get safeOrigin(){return"*"}get recoveryExists(){return!!this.storeGetKey(this.storageKey)}set recoveryExists(e){e?this.storeSetKey(this.storageKey,!0):this.storeRemoveKey(this.storageKey)}storeSetKey(e,t){try{window.sessionStorage.setItem(e,t)}catch(t){this.con_log("baton: cannot SET sessionStorage:",e,":",t.message,t.name,t.code)}return this.store[e]=t,t}storeGetKey(e){try{return window.sessionStorage.getItem(e)}catch(t){return this.con_log("baton: cannot READ sessionStorage:",e,":",t.message,t.name,t.code),this.store[e]}}storeRemoveKey(e){try{window.sessionStorage.removeItem(e)}catch(t){this.con_log("baton: cannot READ sessionStorage:",e,":",t.message,t.name,t.code)}delete this.store[e]}stop(){this.con_log("baton: stop"),this.cancelPollOpener(),this.removeListenMessages(),this.removeListenInteraction()}die(){this.con_log("baton: die"),this.stop(),this.recoveryExists=!1,this.dead=!0}}},function(e,t,o){"use strict";o.r(t);var n=o(0);!function(){if(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>-1)(window.console||{warn:function(){}}).warn("baton: unsupported browser");else{var e,t=INSTALL.siteId,o=INSTALL.preview,r=INSTALL.proxy,s=INSTALL_OPTIONS,i=((o||{}).postMessage||{}).direct;"preview"===t&&i&&(s.postMessage=i),window.INSTALL_SCOPE={setOptions:function(e){s=e,a()}},"preview"===t&&"typical.design"===r.originalURL.parsed.host&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c()),a()}function a(){e&&e.die(),e=new n.a(s)}function c(){INSTALL.createElement({selector:".blog-posts",method:"before"}).innerHTML='<ol><li><a href="/key-action.html">Compare: Key action</a></li><li><a href="/other-action.html">Other action A</a></li></ol>',window.console.log("baton: Sample links injected onto preview page")}}()}]);